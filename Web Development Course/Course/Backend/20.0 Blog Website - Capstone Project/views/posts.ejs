<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/style.css" rel="stylesheet">
  </head>

  <%- include("header.ejs") %>
  
  <body>
    <div class="col-md-8 allPosts">
        <h3 class="pb-4 mb-4 fst-italic border-bottom">
          Posts
        </h3>

        <button class="btn btn-primary mb-3" type="button" data-bs-toggle="collapse" data-bs-target="#newPostForm">
          New Post
        </button>

        <div class="collapse" id="newPostForm">
          <form action="/submit" method="POST">
            <div class="mb-3">
                <input type="text" class="form-control" name="title" placeholder="Title">
            </div>
            <div class="mb-3">
                <input type="text" class="form-control" name="date" placeholder="Date">
            </div>
            <div class="mb-3">
                <input type="text" class="form-control" name="author" placeholder="Author">
            </div>
            <div class="mb-3">
                <input type="text" class="form-control" name="text" placeholder="Text">
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
        </div>

        <% if (locals.posts) { %>
          <% posts.forEach(post => { %>
              <article class="blog-post">
                  <h2 class="display-5 link-body-emphasis mb-1"><%= post.title %></h2>
                  <p class="blog-post-meta"><%= post.author %> <%= post.date %></p>
                  <p><%= post.text %></p>
                  <form action="/deletePost" method="POST">
                    <input type="hidden" name="title" value="<%= post.title %>">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
              </article>
          <% }); %>
      <% } %>
      </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <%- include("footer.ejs") %>
  </body>
</html>